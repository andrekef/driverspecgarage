<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Book Now - Driver Spec Garage</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="favicon.png" type="image/png">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <style>
        .booking-container {
            max-width: 800px;
            margin: 50px auto;
            padding: 40px;
            padding-left: max(40px, env(safe-area-inset-left));
            padding-right: max(40px, env(safe-area-inset-right));
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .booking-container h1 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
        }
        .booking-container > p {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
        }

        /* Step indicators */
        .steps {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 30px;
        }
        .step {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.85rem;
            color: #ccc;
        }
        .step.active {
            color: #e74c3c;
            font-weight: 600;
        }
        .step.done {
            color: #27ae60;
        }
        .step-num {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 700;
            background: #eee;
            color: #999;
        }
        .step.active .step-num {
            background: #e74c3c;
            color: white;
        }
        .step.done .step-num {
            background: #27ae60;
            color: white;
        }
        .step-arrow {
            color: #ddd;
            font-size: 0.7rem;
        }

        /* Selectors */
        .selector-group {
            margin-bottom: 24px;
        }
        .selector-group label {
            display: block;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 10px;
            color: #333;
        }
        .selector-group select {
            width: 100%;
            padding: 15px;
            font-size: 16px;
            border: 2px solid #ddd;
            border-radius: 5px;
            background: white;
            cursor: pointer;
            transition: border-color 0.3s;
            -webkit-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23666' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 15px center;
        }
        .selector-group select:hover { border-color: #e74c3c; }
        .selector-group select:focus { outline: none; border-color: #e74c3c; }

        /* Toggle buttons */
        .toggle-options {
            display: flex;
            gap: 12px;
        }
        .toggle-option {
            flex: 1;
            padding: 14px;
            border: 2px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
            font-size: 0.95rem;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        .toggle-option:hover { border-color: #e74c3c; }
        .toggle-option.selected {
            border-color: #e74c3c;
            background: #fef2f2;
        }
        .toggle-option.disabled {
            opacity: 0.4;
            cursor: not-allowed;
            pointer-events: none;
        }
        .toggle-option strong {
            display: block;
            font-size: 0.95rem;
            color: #333;
        }
        .toggle-option .toggle-sub {
            font-size: 0.8rem;
            color: #999;
            margin-top: 2px;
        }

        /* Location notice banner */
        .location-notice {
            display: none;
            background: #fff8f0;
            border: 1px solid #f5c48a;
            border-radius: 6px;
            padding: 10px 14px;
            font-size: 0.85rem;
            color: #b45309;
            margin-top: 10px;
            line-height: 1.5;
        }
        .location-notice.visible {
            display: block;
        }

        /* Summary card */
        .summary-card {
            background: #f8f9fa;
            padding: 20px 24px;
            border-radius: 8px;
            margin-bottom: 24px;
            border-left: 4px solid #e74c3c;
            display: none;
        }
        .summary-card.active { display: block; }
        .summary-card h3 {
            margin: 0 0 12px 0;
            color: #333;
            font-size: 1.1rem;
        }
        .summary-row {
            display: flex;
            justify-content: space-between;
            padding: 4px 0;
            font-size: 0.9rem;
        }
        .summary-row .label { color: #777; }
        .summary-row .value { color: #333; font-weight: 500; }
        .summary-row .value.price {
            color: #e74c3c;
            font-weight: 700;
            font-size: 1.1rem;
        }
        .summary-desc {
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid #eee;
            font-size: 0.85rem;
            color: #777;
            line-height: 1.6;
        }

        /* Book button */
        .book-button {
            width: 100%;
            padding: 18px;
            font-size: 18px;
            font-weight: 600;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.2s;
            text-transform: uppercase;
            letter-spacing: 1px;
            min-height: 56px;
        }
        .book-button:hover { background: #c0392b; }
        .book-button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .seasonal-badge {
            display: inline-block;
            background: #2c3e50;
            color: white;
            padding: 2px 7px;
            border-radius: 3px;
            font-size: 10px;
            margin-left: 4px;
            font-weight: 700;
            letter-spacing: 0.5px;
            vertical-align: middle;
        }

        /* Mobile */
        @media (max-width: 600px) {
            .booking-container {
                margin: 20px auto;
                padding: 24px 16px;
                border-radius: 0;
                box-shadow: none;
            }
            .toggle-options { gap: 8px; }
            .toggle-option {
                padding: 12px 8px;
                font-size: 0.85rem;
            }
            .toggle-option strong { font-size: 0.85rem; }
            .steps {
                gap: 4px;
                font-size: 0.75rem;
            }
            .book-button {
                font-size: 16px;
                min-height: 52px;
            }
        }

        @media (hover: none) and (pointer: coarse) {
            .toggle-option, .book-button { min-height: 48px; }
        }
    </style>
</head>
<body>
    <header>
        <div class="logo">
            <a href="index.html"><img src="driverspecgarage_new_logo.JPG" alt="Driver Spec Garage Logo"></a>
        </div>
        <nav>
            <ul>
                <li class="non-clickable">
                    <a href="#" onclick="toggleDropdown(event)">Services</a>
                    <ul class="dropdown" id="servicesDropdown">
                        <li><a href="paint-correction.html">Paint Correction</a></li>
                        <li><a href="ceramic-coating.html">Ceramic Coating</a></li>
                        <li><a href="interior-steaming.html">Interior Steaming</a></li>
                        <li><a href="packages.html">Packages</a></li>
                    </ul>
                </li>
                <li><a href="gallery.html">Gallery</a></li>
                <li><a href="shop.html">Shop</a></li>
                <li><a href="booking.html">Book Now</a></li>
                <li><a href="contact.html">Contact</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <div class="booking-container">
            <h1>Book Your Detail</h1>
            <p>Pick your service, vehicle, and location. We handle the rest.</p>

            <!-- Steps -->
            <div class="steps">
                <div class="step active" id="step1"><span class="step-num">1</span> Service</div>
                <span class="step-arrow">&#9654;</span>
                <div class="step" id="step2"><span class="step-num">2</span> Vehicle</div>
                <span class="step-arrow">&#9654;</span>
                <div class="step" id="step3"><span class="step-num">3</span> Location</div>
                <span class="step-arrow">&#9654;</span>
                <div class="step" id="step4"><span class="step-num">4</span> Book</div>
            </div>

            <!-- 1. Service -->
            <div class="selector-group">
                <label for="service-select">1. What do you need?</label>
                <select id="service-select" onchange="onServiceChange()">
                    <option value="">-- Select a Service --</option>
                    <optgroup label="Detailing Packages">
                        <option value="wash-wax">Wash & Wax (Flushing drop-off only)</option>
                        <option value="maintenance">Maintenance Detail</option>
                        <option value="full-detail">Full Detail</option>
                    </optgroup>
                    <optgroup label="Seasonal">
                        <option value="winter-resurrection">Winter Resurrection &#9733;</option>
                    </optgroup>
                    <optgroup label="Standalone Services">
                        <option value="interior-detail">Interior Detail with Steaming</option>
                        <option value="engine-bay">Engine Bay Detail</option>
                    </optgroup>
                    <optgroup label="Premium Services">
                        <option value="paint-correction-1step">Paint Correction (1-Step)</option>
                        <option value="paint-correction-2step">Paint Correction (2-Step)</option>
                        <option value="ceramic-coating">Ceramic Coating</option>
                    </optgroup>
                </select>
            </div>

            <!-- 2. Vehicle Size -->
            <div class="selector-group">
                <label>2. Vehicle size</label>
                <div class="toggle-options">
                    <div class="toggle-option selected" onclick="selectVehicle('car')" id="btn-car">
                        <strong>Car / Sedan / Coupe</strong>
                    </div>
                    <div class="toggle-option" onclick="selectVehicle('suv')" id="btn-suv">
                        <strong>SUV / Van / Truck</strong>
                    </div>
                </div>
            </div>

            <!-- 3. Location -->
            <div class="selector-group">
                <label>3. Where?</label>
                <div class="toggle-options">
                    <div class="toggle-option selected" onclick="selectLocation('mobile')" id="btn-mobile">
                        <strong>Mobile</strong>
                        <div class="toggle-sub">We come to you</div>
                    </div>
                    <div class="toggle-option" onclick="selectLocation('flushing')" id="btn-flushing">
                        <strong>Flushing</strong>
                        <div class="toggle-sub">Drop off and save</div>
                    </div>
                </div>
                <!-- Notice shown when Flushing-only service + mobile selected -->
                <div class="location-notice" id="location-notice">
                    ðŸš— Wash &amp; Wax is available at our <strong>Flushing location only</strong>. We've switched you to drop-off. Need mobile? Book a <a href="booking.html?service=maintenance" style="color:#b45309; font-weight:600;">Maintenance Detail</a> instead.
                </div>
            </div>

            <!-- Summary -->
            <div class="summary-card" id="summary">
                <h3 id="summary-title"></h3>
                <div class="summary-row">
                    <span class="label">Vehicle</span>
                    <span class="value" id="summary-vehicle"></span>
                </div>
                <div class="summary-row">
                    <span class="label">Location</span>
                    <span class="value" id="summary-location"></span>
                </div>
                <div class="summary-row">
                    <span class="label">Duration</span>
                    <span class="value" id="summary-duration"></span>
                </div>
                <div class="summary-row">
                    <span class="label">Price</span>
                    <span class="value price" id="summary-price"></span>
                </div>
                <div class="summary-desc" id="summary-desc"></div>
            </div>

            <!-- Book -->
            <button class="book-button" id="book-button" onclick="openCalendly()" disabled>
                Select a Service to Continue
            </button>
        </div>
    </main>

    <footer>
        <div class="footer-content">
            <p>&copy; 2025 Driver Spec Garage &nbsp;|&nbsp; 646-484-8689 &nbsp;|&nbsp; <a href="mailto:driverspecgarage@gmail.com">driverspecgarage@gmail.com</a></p>
        </div>
    </footer>

    <script>
        // ========== DATA ==========
        // flushingOnly: true  â†’ mobile option is disabled, auto-force Flushing
        // Pricing: [mobile-car, mobile-suv, flushing-car, flushing-suv]
        const services = {
            'wash-wax': {
                name: 'Wash & Wax',
                flushingOnly: true,
                prices: { 'mobile-car': 60, 'mobile-suv': 70, 'flushing-car': 60, 'flushing-suv': 70 },
                duration: 'About 45 minutes',
                desc: 'Quick exterior refresh. Pre-foam hand wash, protector wax, wheels and tires dressed, door jambs, gas cap, exhaust tips, windows inside and out. Add interior vacuum and wipe down for +$20.',
                addon: '+$20 interior vacuum and wipe down'
            },
            'maintenance': {
                name: 'Maintenance Detail',
                prices: { 'mobile-car': 120, 'mobile-suv': 140, 'flushing-car': 110, 'flushing-suv': 130 },
                duration: '1 to 1.5 hours',
                desc: 'Full refresh. Everything in Wash & Wax plus ceramic sealant (lasts about 1 month), engine bay detailed, full interior vacuum and wipe down, headliner, console, vents and crevices cleaned.'
            },
            'full-detail': {
                name: 'Full Detail',
                prices: { 'mobile-car': 250, 'mobile-suv': 280, 'flushing-car': 220, 'flushing-suv': 250 },
                duration: '2 to 5 hours',
                desc: 'The deep clean reset. Everything in Maintenance Detail plus iron, tar and clay bar decontamination, graphene ceramic sealant (3-4 months), leather deep clean and conditioning, carpet and mat shampooing, steam sanitization, dashboard and trim protection.'
            },
            'winter-resurrection': {
                name: 'Winter Resurrection',
                prices: { 'mobile-car': 180, 'mobile-suv': 200, 'flushing-car': 150, 'flushing-suv': 170 },
                duration: '3 to 3.5 hours',
                desc: 'Limited time winter service. Your paint is not scratched, it is contaminated. Acid wash to dissolve water spots and mineral deposits, iron decontamination, undercarriage acid foam and rinse, machine wax application, wheels and tires, door jambs and windows, basic interior vacuum and wipe down. Add full interior with steaming, shampoo and leather conditioning for +$100.',
                addon: '+$100 full interior with steaming, shampoo and leather conditioning'
            },
            'interior-detail': {
                name: 'Interior Detail with Steaming',
                prices: { 'mobile-car': 180, 'mobile-suv': 200, 'flushing-car': 180, 'flushing-suv': 200 },
                duration: '2 to 2.5 hours',
                desc: 'Standalone deep interior clean. High-temperature steam cleaning (kills 99.9% of bacteria), deep vacuum, carpet and mat shampooing, leather deep clean and conditioning, stain and odor removal, all panels, trim, vents and headliner, door jambs and interior glass.',
                samePrice: true
            },
            'engine-bay': {
                name: 'Engine Bay Detail',
                prices: { 'mobile-car': 50, 'mobile-suv': 50, 'flushing-car': 50, 'flushing-suv': 50 },
                duration: '30 to 45 minutes',
                desc: 'Complete engine compartment cleaning and dressing. Engine degreasing, component detailing, plastic and rubber dressing. Can be added to any package for $30 instead of $50 standalone.',
                samePrice: true
            },
            'paint-correction-1step': {
                name: 'Paint Correction (1-Step)',
                prices: { 'mobile-car': 400, 'mobile-suv': 400, 'flushing-car': 400, 'flushing-suv': 400 },
                duration: '4 to 5 hours',
                desc: 'Single-step machine polish. Removes about 70-80% of swirls, light scratches and paint defects. Great for newer vehicles or minor imperfections. Same price for all vehicles.',
                samePrice: true
            },
            'paint-correction-2step': {
                name: 'Paint Correction (2-Step)',
                prices: { 'mobile-car': 600, 'mobile-suv': 600, 'flushing-car': 600, 'flushing-suv': 600 },
                duration: '6 to 8 hours',
                desc: 'Two-step correction. Compound stage for defect removal, then fine polish for clarity. Removes about 90% of swirls, scratches and defects. Best for heavily swirled or neglected paint. Same price for all vehicles.',
                samePrice: true
            },
            'ceramic-coating': {
                name: 'Ceramic Coating',
                prices: { 'mobile-car': 900, 'mobile-suv': 900, 'flushing-car': 900, 'flushing-suv': 900 },
                duration: '1 to 2 days',
                desc: 'Professional ceramic coating with paint correction included. Long-term protection (2-3+ years). Requires proper application and curing time. Same price for all vehicles.',
                samePrice: true
            }
        };

        let selectedService = '';
        let selectedVehicle = 'car';
        let selectedLocation = 'mobile';

        // ========== UI FUNCTIONS ==========
        function selectVehicle(size) {
            selectedVehicle = size;
            document.getElementById('btn-car').classList.toggle('selected', size === 'car');
            document.getElementById('btn-suv').classList.toggle('selected', size === 'suv');
            updateSummary();
        }

        function selectLocation(loc) {
            // If trying to select mobile for a flushing-only service, block it
            if (loc === 'mobile' && selectedService && services[selectedService] && services[selectedService].flushingOnly) {
                return;
            }
            selectedLocation = loc;
            document.getElementById('btn-mobile').classList.toggle('selected', loc === 'mobile');
            document.getElementById('btn-flushing').classList.toggle('selected', loc === 'flushing');
            updateSummary();
        }

        function onServiceChange() {
            selectedService = document.getElementById('service-select').value;

            const svc = selectedService ? services[selectedService] : null;
            const mobileBtn = document.getElementById('btn-mobile');
            const notice = document.getElementById('location-notice');

            if (svc && svc.flushingOnly) {
                // Force Flushing, disable Mobile toggle
                mobileBtn.classList.add('disabled');
                mobileBtn.classList.remove('selected');
                document.getElementById('btn-flushing').classList.add('selected');
                selectedLocation = 'flushing';
                notice.classList.add('visible');
            } else {
                // Re-enable Mobile toggle
                mobileBtn.classList.remove('disabled');
                notice.classList.remove('visible');
                // Restore mobile as default if it was previously selected
                if (!document.getElementById('btn-mobile').classList.contains('selected') &&
                    !document.getElementById('btn-flushing').classList.contains('selected')) {
                    document.getElementById('btn-mobile').classList.add('selected');
                    selectedLocation = 'mobile';
                }
            }

            updateSummary();
        }

        function updateSummary() {
            const summary = document.getElementById('summary');
            const btn = document.getElementById('book-button');

            // Update step indicators
            const hasService = selectedService !== '';
            document.getElementById('step1').className = hasService ? 'step done' : 'step active';
            document.getElementById('step2').className = hasService ? 'step done' : 'step';
            document.getElementById('step3').className = hasService ? 'step done' : 'step';
            document.getElementById('step4').className = hasService ? 'step active' : 'step';

            if (!hasService) {
                summary.classList.remove('active');
                btn.disabled = true;
                btn.textContent = 'Select a Service to Continue';
                return;
            }

            const svc = services[selectedService];
            const priceKey = selectedLocation + '-' + selectedVehicle;
            const price = svc.prices[priceKey];

            document.getElementById('summary-title').textContent = svc.name;
            document.getElementById('summary-vehicle').textContent = selectedVehicle === 'car' ? 'Car / Sedan / Coupe' : 'SUV / Van / Truck';
            document.getElementById('summary-location').textContent = selectedLocation === 'mobile' ? 'Mobile (we come to you)' : 'Flushing drop-off';
            document.getElementById('summary-duration').textContent = svc.duration;
            document.getElementById('summary-price').textContent = '$' + price;

            let descText = svc.desc;
            if (svc.addon) descText += '\n\nAdd-on available: ' + svc.addon;
            document.getElementById('summary-desc').textContent = descText;

            summary.classList.add('active');
            btn.disabled = false;
            btn.textContent = 'Book Now â€” $' + price;
        }

        function openCalendly() {
            if (!selectedService) {
                alert('Please select a service first');
                return;
            }
            const svc = services[selectedService];
            const priceKey = selectedLocation + '-' + selectedVehicle;
            const price = svc.prices[priceKey];
            const vehicleType = selectedVehicle === 'car' ? 'Car/Sedan/Coupe' : 'Van/SUV/Truck';
            const locationLabel = selectedLocation === 'mobile' ? 'Mobile' : 'Flushing';
            const fullServiceString = svc.name + ' (' + locationLabel + ') - $' + price + ' (' + vehicleType + ')';
            const serviceCode = selectedService + '-' + selectedLocation + '-' + selectedVehicle;

            const params = new URLSearchParams({
                a1: '+1',
                a2: fullServiceString,
                a3: vehicleType,
                a4: serviceCode
            });

            window.open('https://calendly.com/andrekef?' + params.toString(), '_blank');
        }

        // ========== AUTO-FILL FROM URL PARAMS ==========
        function autoFillFromURL() {
            const params = new URLSearchParams(window.location.search);

            const svc = params.get('service');
            if (svc && services[svc]) {
                document.getElementById('service-select').value = svc;
                selectedService = svc;
            }

            const veh = params.get('vehicle');
            if (veh === 'car' || veh === 'suv') selectVehicle(veh);

            // Run service change logic first (handles flushingOnly enforcement)
            if (selectedService) onServiceChange();

            // Then apply URL location param (only if service allows it)
            const loc = params.get('location');
            if (loc === 'flushing') {
                selectLocation('flushing');
            } else if (loc === 'mobile' && selectedService && !services[selectedService].flushingOnly) {
                selectLocation('mobile');
            }

            if (svc) {
                updateSummary();
                setTimeout(function() {
                    var el = document.getElementById('summary');
                    if (el && window.innerWidth < 700) el.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }, 300);
            }
        }

        // ========== NAV ==========
        function toggleDropdown(event) {
            event.preventDefault();
            event.stopPropagation();
            var dropdown = document.getElementById('servicesDropdown');
            dropdown.style.display = (dropdown.style.display === 'block') ? 'none' : 'block';
        }
        document.addEventListener('click', function(event) {
            var isClickInside = document.querySelector('.non-clickable') && document.querySelector('.non-clickable').contains(event.target);
            if (!isClickInside) document.getElementById('servicesDropdown').style.display = 'none';
        });

        // ========== INIT ==========
        window.addEventListener('DOMContentLoaded', autoFillFromURL);
    </script>
</body>
</html>
